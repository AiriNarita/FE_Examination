# DBの基礎

## スキーマ

- DBの仕様や構造を定義するもの
- 標準的には3層スキーマが使用される
  - 外部スキーマ：どんなふうにData表示するのか
  - 内部スキーマ：ハードウェアにどう保存するか
  - 概念スキーマ: データの関連性について

## ACID原則(アコイド原則)

トランザクション処理には、**4つの特性(求められる性質) "ACID"** がある.(特にAとIは大事)

> トランザクション<br>
> 関連する複数の処理を一つの処理として実行・管理する仕組み。<br>
> 簡単に言えば、**ひとまとまりの処理のこと**

| 特性     | 説明                                         |
|----------|----------------------------------------------|
| **`Atomicity`: 原子性**   | すべての操作が完全に実行されるか、一切実行されないかのどちらかであることを保証する。   |
| **`Consistency`: 一貫性**   | トランザクションの実行前後でデータベースの整合性が保たれること。         |
| **`Isolation`: 独立性,分離性**   | 同時に実行されても、トランザクションは互いに影響を及ぼさないこと。     |
| **`Durability`: 耐久性**   | トランザクションが完了した後も、変更は永続的で失われないこと。         |

## DB設計について

## 正規化

- **正規化：DBの一貫性をあ持つために必要な処理**
  - 目的は、**データに矛盾や重複を生じさせない**こと
  - 正規化された表のことを正規形と呼ぶ

### ▶︎ 正規化の段階　(関数従属、部分関数従属)

> - [IT用語辞典](https://e-words.jp/w/%E7%AC%AC1%E6%AD%A3%E8%A6%8F%E5%BD%A2.html)
>
![](../../../pic/db.png)

- **関係従属** (functional dependency)とは：<br>
**リレーショナルデータベース（RDB）の表で、
2つの属性の間で片方の値を決定すると、もう一方の値が一意に決まるという性質** のこと。

- 部分関数従属とは: <br>
リレーショナルデータベース（RDB）の表で、<br>
ある属性が複数の候補キーのいずれかに関数従属している状態のこと。

## 排他制御

### 楽観ロック (Optimistic Locking)

**データそのものに対してロックは行わずに、
更新対象のデータが、データ取得時と同じ状態であることを確認してから更新**することで、
データの整合性を保証する手法。

<img width="1060" alt="スクリーンショット 2024-04-11 0 32 36" src="https://github.com/AiriNarita/DevConnect/assets/119647023/b50eac9d-0b5d-4491-bfa6-3956bb1265f9">

### 悲観ロック (Pessimistic Locking)

更新対象のデータを取得する際に(selectの時点で)ロックをかけることことで、
他のトランザクションから更新されないようにする手法。
<img width="811" alt="スクリーンショット 2024-04-12 0 04 46" src="https://github.com/AiriNarita/DevConnect/assets/119647023/fa9a69e0-85fb-4eae-9523-b077403f31b2">

`select ... for update;`

## 障害管理

### コミット/ロールバック

### ロールフォワード

### ウォームスタート/コールドスタート

### ジャーナルファイル

### レプリケーション
